_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[19],{JX7q:function(e,t,n){"use strict";function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return o}))},YSrY:function(e,t,n){"use strict";n.r(t),n.d(t,"__N_SSG",(function(){return he}));var o=n("nKUr"),r=n("MX0m"),a=n.n(r),i=n("1OyB"),c=n("vuIU"),s=n("rePB"),l=n("tzYf"),u=n("hKI/"),f=n.n(u),d=n("JX7q");function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return(h="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){return!t||"object"!==h(t)&&"function"!==typeof t?Object(d.a)(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function b(e,t,n){return(b=m()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var r=new(Function.bind.apply(e,o));return n&&p(r,n.prototype),r}).apply(null,arguments)}function y(e){var t="function"===typeof Map?new Map:void 0;return(y=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return b(e,arguments,v(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),p(o,e)})(e)}function x(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function j(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=v(e);if(t){var r=v(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return g(this,n)}}var N=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,e);var t=j(n);function n(){var e;Object(i.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),Object(s.a)(Object(d.a)(e),"trackNumber",-1),e}return n}(y(Array)),T=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(Object(i.a)(this,e),Object(s.a)(this,"notes",void 0),Object(s.a)(this,"playTimeMillis",-1),Object(s.a)(this,"trackNumber",0),Object(s.a)(this,"noteNumber",-1),this.playTimeMillis=n,this.trackNumber=o,"string"===typeof t){var r=t;if(-1!==r.indexOf("[")){var a=/\[\s*(.+)\s*\@\s*(.+)\s*\]/,c=a.exec(r);r=c[1];var l=c[2];this.playTimeMillis=parseFloat(l)}var u,f=[],d=r.split("."),p=x(d);try{for(p.s();!(u=p.n()).done;){var h=u.value,g=parseInt(h);f.push(new w(g))}}catch(v){p.e(v)}finally{p.f()}this.notes=f}else this.notes=t?[t]:[]}return Object(c.a)(e,[{key:"addNote",value:function(e){this.notes.push(e);var t=this.notes.length;if(t>1){this.notes.sort(w.compare);for(var n=[this.notes[0]],o=1;o<t;o++){var r=n[n.length-1],a=this.notes[o];a.pianoNote!==r.pianoNote&&n.push(a)}this.notes=n}}},{key:"toString",value:function(){return-1===this.playTimeMillis?this.notes.join("."):"[".concat(this.notes.join(".")," @ ").concat(this.playTimeMillis,"]")}},{key:"toJSON",value:function(){return this.toString()}},{key:"toFullString",value:function(){return"".concat(this.notes.join(".")," @ ").concat(this.playTimeMillis," with trackIndex: ").concat(this.trackNumber," noteGroupIndex: ").concat(this.noteNumber)}},{key:"toStringV1",value:function(){return this.notes.join(".")}},{key:"copy",value:function(){var t=new e(this.toString());return t.playTimeMillis=this.playTimeMillis,t.trackNumber=this.trackNumber,t.noteNumber=this.noteNumber,t}},{key:"numNotes",get:function(){return this.notes.length}}],[{key:"merge",value:function(t,n){var o,r=new e,a=x(t.notes);try{for(a.s();!(o=a.n()).done;){var i=o.value;r.addNote(i)}}catch(u){a.e(u)}finally{a.f()}var c,s=x(n.notes);try{for(s.s();!(c=s.n()).done;){var l=c.value;r.addNote(l)}}catch(u){s.e(u)}finally{s.f()}return r}}]),e}(),w=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:127;Object(i.a)(this,e),Object(s.a)(this,"pianoNote",void 0),Object(s.a)(this,"midiNote",void 0),Object(s.a)(this,"durationMillis",void 0),Object(s.a)(this,"velocity",void 0),this.pianoNote=t,this.midiNote=t+20,this.durationMillis=n,this.velocity=o}return Object(c.a)(e,null,[{key:"compare",value:function(e,t){return e.pianoNote-t.pianoNote}}]),Object(c.a)(e,[{key:"toString",value:function(){return this.pianoNote+""}}]),e}();function O(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var I,C,M,F,G,A,P=[],E=[],D="",R="",L=0,K=1,B=null,V=null,J=null,z=null,H=null,W=[2,-1,5,7,-1,10,0],q=[1,3,4,6,8,9,11],U=["a","b","c","d","e","f","g"],X=0,Y=new l.b;function Q(e){return e-20}function Z(){console.log("Reset Everything!"),L=0,re(1),ce.checkAllNonEmptyTracks(),ee(),ie.stop(),$("#file-info").html("&nbsp;"),$("#song-info").html("&nbsp;")}function ee(){F.saveCheckBoxes(),F.saveTracks(),ce.showNoteGroupsForTracks(),ce.drawPiano()}function te(e,t){return"t".concat(e,"_n").concat(t)}function ne(e,t){var n=te(e,t),o=document.querySelector("#".concat(n));o&&o.scrollIntoView()}function oe(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e%12,o=q.indexOf(n),r=U[o],a=0;t&&(a=X,-1!=D.indexOf(r)&&a++,-1!=R.indexOf(r)&&a--);var i=e+a+12*L;if(!(i<1||i>88)){var c=G.currentTrack(),s=se.addNoteGroupToTrack(new T(new w(i)),c);ce.setCheckedState(c,!0),ae(i),G.setTrackAndNoteGroup(c,s-1),ee()}}function re(e){se.reset(),P=[],E=[],function(e){for(var t="",n=0;n<e;n++){se.addTrack(n);var o='<input id="track-'.concat(n,'-checkbox" type="checkbox" class="checkbox">'),r='<div id="track-'.concat(n,'-info" class="track-info"></div>'),a='<div id="track-'.concat(n,'" class="track">');t+='<div id="track-'.concat(n,'-container" class="track-container">').concat(o).concat(r).concat(a,"</div></div>")}$("#tracks").html(t);for(var i=function(e){$("#track-".concat(e,"-checkbox")).change((function(){ce.setCheckedState(e,this.checked),F.saveCheckBoxes(),se.invalidateCache()})),P.push($("#track-".concat(e))),E.push($("#track-".concat(e,"-info")))},c=0;c<e;c++)i(c)}(e),G.setupIndexes()}function ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:127,n=1;Y.play(e,n,t/127)}(C=I||(I={})).labels=["\u2423","z","x","c","v","b","n","m",",",".","/","a","s","d","f","g","h","j","k","l",";","q","w","e","r","t","y","u","i","o","p","[","]","\\","1","2","3","4","5","6","7","8","9","0","-","="],C.keyCodeToPianoKeyNumber={32:11,90:13,88:15,67:16,86:18,66:20,78:21,77:23,188:25,190:27,191:28,65:30,83:32,68:33,70:35,71:37,72:39,74:40,75:42,76:44,186:45,59:45,222:47,81:47,87:49,69:51,82:52,84:54,89:56,85:57,73:59,79:61,80:63,219:64,221:66,220:68,49:69,50:71,51:73,52:75,53:76,54:78,55:80,56:81,57:83,48:85,189:87,187:88},function(e){var t=0;function n(e){for(var t=e.inputs.values(),n=t.next();n&&!n.done;n=t.next())n.value.onmidimessage=r}function o(e){console.log("No access to MIDI devices or your browser doesn't support WebMIDI API."+e)}function r(e){var n=e.data,o=(n[0],n[0],240&n[0]),r=n[1],a=n[2],i=r-20;switch(o){case 144:console.log("piano key down: "+i+" velocity: "+a),oe(i,!1),++t>1&&se.mergeLastTwoGroups();break;case 128:t--;break;case 224:console.log("pitch wheel")}}e.setup=function(){navigator.requestMIDIAccess?navigator.requestMIDIAccess({sysex:!1}).then(n,o):alert("No MIDI support in your browser.")}}(M||(M={})),function(e){function t(){localStorage.setItem("checkboxes",JSON.stringify(ce.getCheckedStateArray()))}e.load=function(){!function(){try{var e=JSON.parse(localStorage.getItem("tracks")),t=e.length;re(t);for(var n=0;n<t;n++){var o,r=O(e[n]);try{for(r.s();!(o=r.n()).done;){var a=o.value,i=new T(a);se.addNoteGroupToTrack(i,n)}}catch(c){r.e(c)}finally{r.f()}}}catch(s){re(1)}}(),function(){localStorage.getItem("sharps")||localStorage.setItem("sharps","");D=localStorage.getItem("sharps"),localStorage.getItem("flats")||localStorage.setItem("flats","");R=localStorage.getItem("flats"),ce.updateSharpsAndFlats()}(),function(){try{var e=JSON.parse(localStorage.getItem("checkboxes"));if(!Array.isArray(e)||e.length!==se.getNumTracks())throw"OOPS";ce.setCheckedStateArray(e)}catch(n){ce.checkAllNonEmptyTracks(),t()}}(),function(){localStorage.getItem("song_version")||localStorage.setItem("song_version","1");1!==(K=parseInt(localStorage.getItem("song_version")))&&2!==K&&(K=1);ce.updateVersionToggle()}()},e.saveCheckBoxes=t,e.saveTracks=function(){var e=se.getTracksAsJSON();localStorage.setItem("tracks",e)},e.saveSharpsAndFlats=function(){localStorage.setItem("sharps",D),localStorage.setItem("flats",R)},e.saveVersionToggle=function(){localStorage.setItem("song_version",K+"")}}(F||(F={})),function(e){var t="highlight",n=0,o=[],r=null,a=null,i=null;function c(){return o[n]}function s(){P.length;r&&r.removeClass(t),a&&a.removeClass(t),i&&i.removeClass(t),r=P[n].addClass(t),a=E[n].addClass(t),i=$("#"+te(n,c())).addClass(t),ce.drawPiano()}function l(){var e=se.getNumTracks();n<0?n=0:n>=e&&(n=e-1)}function u(e){o[n]=e}function f(){!function(){var e=se.getNumNoteGroupsInTrack(n),t=c();t<0?u(0):t>=e&&u(e-1)}(),s(),ne(n,c())}e.setupIndexes=function(){n=0,o=[];for(var e=se.getNumTracks(),t=0;t<e;t++)o.push(0)},e.currentTrack=function(){return n},e.currentNoteGroup=c,e.update=s,e.setTrackAndNoteGroup=function(e,t){n=e,u(t),l(),f()},e.prevTrack=function(){n--,l(),s()},e.nextTrack=function(){n++,l(),s()},e.prevNoteGroup=function(){o[n]--,f()},e.nextNoteGroup=function(){o[n]++,f()},e.firstNoteGroup=function(){u(0),f()},e.lastNoteGroup=function(){u(se.getNumNoteGroupsInTrack(n)-1),f()}}(G||(G={})),function(e){var t=null,n=null;function o(e){console.log("parseData"),ie.stop();var o=(t=new MIDIFile(e)).header,r=o.getFormat(),a=o.getTracksCount();console.log("MIDI Format: ".concat(r)),o.getTimeDivision()===MIDIFile.Header.TICKS_PER_BEAT?console.log("Ticks Per Beat: ".concat(o.getTicksPerBeat())):console.log("TODO: SMPTE Frames!"),function(){re(t.tracks.length),n=t.getMidiEvents();var e,o=null,r=-1,a=-1,i=O(n);try{for(i.s();!(e=i.n()).done;){var c=e.value,s=(c.type,c.subtype),l=c.track,u=c.playTime;u=Math.round(1e3*u)/1e3;var f=c.param1,d=c.param2,p=Q(f),h=new w(p,1,d);if(s===MIDIEvents.EVENT_MIDI_NOTE_ON)if(u<=r+0&&l===a)o.addNote(h);else{var g=new T(h,u,l);se.addNoteGroupToTrack(g,l),o=g,a=l,r=u}}}catch(v){i.e(v)}finally{i.f()}ce.checkAllNonEmptyTracks(),ee()}();var i=t.getLyrics();i.length>0&&console.log("Lyrics Track ".concat(i.length," events.")),function(e){var t=Math.round(100*e.duration)/100;$("#song-info").text("Num Tracks: ".concat(e.numTracks," | Duration: ").concat(t," secs"))}({numTracks:a,duration:n[n.length-1].playTime/1e3})}e.hasLoadedAFile=function(){return null!==t},e.getFileFromTracks=function(){for(var e=new Midi.File,t=new Map,n=se.getNumTracks(),o=0;o<n;o++)if(ce.isChecked(o)){var r=new Midi.Track;r.setTempo(240);r.setInstrument(0,0),t[o]=r,e.addTrack(r)}var a,i=new Map,c=O(se.getNoteGroupsFromTracks());try{var s=function(){var e=a.value,n=e.trackNumber,o=t[n];if(!o)return console.log("OOPS: MIDI TRACK IS NULL"),"continue";var r=i[n];if(r){i[n]=null;var c=.512*(e.playTimeMillis-r.playTimeMillis);r.notes.forEach((function(e,t){var n=0===t?c:0;o.noteOff(0,e.midiNote,n)}))}e.notes.forEach((function(e,t){o.noteOn(0,e.midiNote,0,e.velocity)})),i[n]=e};for(c.s();!(a=c.n()).done;)s()}catch(f){c.e(f)}finally{c.f()}var l=function(e){var n=t[e];i[e].notes.forEach((function(e,t){var o=0===t?512:0;n.noteOff(0,e.midiNote,o)}))};for(var u in i)l(u);return e.toBytes()},e.readFile=function(e){var t=new FileReader;t.addEventListener("load",(function(t){var n=t.target.result;ce.displayFileInfo(e),o(n)})),t.addEventListener("error",(function(e){console.error("FileReader error"+e)})),t.readAsArrayBuffer(e)}}(A||(A={}));var ie,ce,se,le=function(){function e(){Object(i.a)(this,e),Object(s.a)(this,"isRunning",!1),Object(s.a)(this,"interval",null),Object(s.a)(this,"delay",10),Object(s.a)(this,"onmessage",void 0)}return Object(c.a)(e,[{key:"postMessage",value:function(e){var t=this;switch(e){case"start":console.log("Piano Clock Worker Started"),isRunning||(isRunning=!0,interval=setInterval((function(){t.onmessage&&t.onmessage("tick")}),delay));break;case"stop":default:console.log("Piano Clock Worker Stopped"),clearInterval(interval),isRunning=!1}}}]),e}();function ue(){var e=se.getNoteGroupsFromTracks();if(1===K){var t=[];return e.forEach((function(e){t.push(e.toStringV1())})),t.join(" ")}return e.join(" ")}!function(e){var t=0,n=0,o=0,r=new le,a=!1;r.onmessage=function(e){!function(e){var r=se.getNoteGroupsFromTracks();if(i>=r.length)return void ie.stop();t=e-o+n;for(;t>=s;){var a=r[i];if(G.setTrackAndNoteGroup(a.trackNumber,a.noteNumber),b(),++i>=r.length)return void ie.stop();g()}}(performance.now())};var i=0,c=!1,s=0;function l(){return a}function u(){if(c)n=t;else{if(l()&&p(),0===se.getNoteGroupsFromTracks().length)return void ie.stop();i=0,t=0,n=0,g()}c=!1,o=performance.now(),r.postMessage("start"),a=!0}function d(){h(),c=!0}function p(){h(),i=0}function h(){l()&&(r.postMessage("stop"),a=!1)}function g(){var e=se.getNoteGroupsFromTracks();-1===(s=e[i].playTimeMillis)&&(s=t+250)}function v(){var e=se.getNoteGroupsFromTracks();i>=e.length?i=e.length-1:i<0&&(i=0)}e.isPlaying=l,e.play=u,e.pause=d,e.togglePlayPause=function(){l()?d():u()},e.stop=p,e.setupButtons=function(){J.click(u),z.click(d),H.click(p)};e.playNoteAndGoBackwardInTheSong=f()((function(){m(-1)}),150),e.playNoteAndGoForwardInTheSong=f()((function(){m(1)}),150);function m(e){var t=se.getNoteGroupsFromTracks();if(0!==t.length){v();var n=t[i];G.setTrackAndNoteGroup(n.trackNumber,n.noteNumber),b(),i+=e,v()}}function b(){var e=G.currentTrack(),t=G.currentNoteGroup(),n=se.getNoteGroupFromTrack(t,e);if(n){var o,r=O(n.notes);try{for(r.s();!(o=r.n()).done;){var a=o.value;ae(Q(a.midiNote),a.velocity)}}catch(c){r.e(c)}finally{r.f()}var i=$("#t".concat(e,"_n").concat(t));i.addClass("played-note"),setTimeout((function(){i.removeClass("played-note")}),400)}}e.playAndGoBackwardOnCurrentTrack=f()((function(){b(),G.prevNoteGroup()}),150),e.playAndGoForwardOnCurrentTrack=f()((function(){b(),G.nextNoteGroup()}),150)}(ie||(ie={})),function(e){var t,n,o,r;function a(e){if(Y.isInitialized||Y.initWebAudio(),!t.is(":focus")&&!n.is(":focus")){var o=e.keyCode;if(!e.metaKey||37==o||39==o)switch(X=0,e.ctrlKey&&(X=-1),e.shiftKey&&(X=1),e.preventDefault(),o){case 13:ie.togglePlayPause();break;case 33:console.log("fn + UP"),++L>2&&(L=2),ce.drawPiano();break;case 34:console.log("fn + DOWN"),--L<-2&&(L=-2),ce.drawPiano();break;case 36:ie.playNoteAndGoBackwardInTheSong();break;case 35:ie.playNoteAndGoForwardInTheSong();break;case 112:console.log("F1");break;case 113:console.log("F2");break;case 114:console.log("F3");break;case 115:console.log("F4");break;case 116:console.log("F5");break;case 192:console.log("SHIFT + `"),Z();break;case 27:console.log("ESC"),e.shiftKey?Z():(console.log("Reset Offsets"),L=0,ce.drawPiano());break;case 8:se.deleteLastGroup();break;case 9:se.mergeLastTwoGroups();break;case 38:G.prevTrack();break;case 40:G.nextTrack();break;case 37:e.metaKey?G.firstNoteGroup():e.shiftKey?ie.playAndGoBackwardOnCurrentTrack():G.prevNoteGroup();break;case 39:e.metaKey?G.lastNoteGroup():e.shiftKey?ie.playAndGoForwardOnCurrentTrack():G.nextNoteGroup();break;default:I.keyCodeToPianoKeyNumber.hasOwnProperty(o)&&oe(I.keyCodeToPianoKeyNumber[o])}}}function i(e){t.is(":focus")?(D=t.val().toLowerCase(),F.saveSharpsAndFlats()):n.is(":focus")?(R=n.val().toLowerCase(),F.saveSharpsAndFlats()):(e.ctrlKey||e.shiftKey)&&(X=0)}e.updateSharpsAndFlats=function(){t.val(D),n.val(R)},e.updateVersionToggle=function(){o.removeClass("selected"),r.removeClass("selected"),1===K?o.addClass("selected"):r.addClass("selected")},e.setupJQueryDOMReferences=function(){o=$("#toggle_v1"),r=$("#toggle_v2"),t=$("#sharps-text"),n=$("#flats-text"),$("#current-status"),B=$("#download_midi_link"),V=$("#download_text_link"),J=$("#play-button"),z=$("#pause-button"),H=$("#stop-button")},e.setupCopyHandler=function(){document.querySelector("html").addEventListener("copy",(function(e){if(e.preventDefault(),console.log("COPY"),e.clipboardData){var t=ue();e.clipboardData.setData("text/plain",t)}})),document.querySelector("html").addEventListener("cut",(function(e){if(e.preventDefault(),console.log("CUT"),e.clipboardData){var t=ue();e.clipboardData.setData("text/plain",t)}Z()}))},e.showNoteGroupsForTracks=function(){for(var e=se.getNumTracks(),t=0;t<e;t++){for(var n="",o=se.getNumNoteGroupsInTrack(t),r=0;r<o;r++){var a=se.getNoteGroupFromTrack(r,t),i=a.numNotes>1?" multiple":"",c=te(t,r);n+='<div id="'.concat(c,'" class="notegroup').concat(i,'">').concat(a.toString(),"</div>")}P[t].html(n),o>0?(E[t].html("".concat(o)),$("#track-".concat(t,"-container")).removeClass("empty")):(E[t].html(""),ce.setCheckedState(t,!1),$("#track-".concat(t,"-container")).addClass("empty")),$("#track-".concat(t,"-checkbox")).prop("checked",ce.isChecked(t)),ne(t,r)}G.update()},e.displayFileInfo=function(e){$("#file-info").text("Loaded File: ".concat(e.name," | Size: ").concat(e.size," bytes"))},e.setupFileChooser=function(){var e=$("#filechooser");e.change((function(e){var t=e.target.files;t.length>0&&A.readFile(t[0])})),$("#filechooserlabel").mousedown((function(t){e[0].value=null}))},e.setupMouseHandlers=function(){ie.setupButtons(),o.click((function(){K=1,F.saveVersionToggle(),ce.updateVersionToggle()})),r.click((function(){K=2,F.saveVersionToggle(),ce.updateVersionToggle()})),B.mouseover((function(){var e=A.getFileFromTracks(),t=btoa(e);B.attr("href","data:audio/midi;base64,"+t)})),V.mouseover((function(){var e=ue(),t=btoa(e);V.attr("href","data:text/plain;base64,"+t)})),DragDrop("html",{onDrop:function(e,t){A.readFile(e[0])},onDragOver:function(){$("#bottom-panel").addClass("drag")},onDragLeave:function(){$("#bottom-panel").removeClass("drag")}})},e.setupKeyHandlers=function(){$(document).bind("keydown",a).bind("keyup",i)};var c=[!0];e.isChecked=function(e){return c[e]},e.checkAllNonEmptyTracks=function(){c=[];for(var e=se.getNumTracks(),t=0;t<e;t++)se.getNumNoteGroupsInTrack(t)>0?c.push(!0):c.push(!1)},e.setCheckedState=function(e,t){c[e]=t},e.setCheckedStateArray=function(e){c=e},e.getCheckedStateArray=function(){return c};var s=e.BLACK_KEY_HEIGHT=72,l=null,u=0,f=0;e.setupPianoCanvas=function(){var e=document.getElementById("pianoCanvas");e.width=2080,e.height=300,e.style.width="1040px",e.style.height="150px",u=e.width,f=e.height,(l=e.getContext("2d")).scale(2,2)},e.drawPiano=function(){if(l){var e=l;e.fillStyle="#444",e.fillRect(0,0,u,f),function(e){e.strokeStyle="#000",e.lineWidth=.2,e.fillStyle="#FFF";for(var t=0;t<52;t++)e.fillRect(20*t,0,20,120),e.strokeRect(20*t,0,20,120);e.fillStyle="#FCC",e.fillRect(460,0,20,120)}(e),function(e){e.fillStyle="#323232";for(var t=0;t<7;t++)for(var n=0;n<7;n++)1!=n&&4!=n&&e.fillRect(12+20*(n+7*t),0,16,s);e.fillRect(992,0,16,72)}(e),function(e){e.textAlign="center";for(var t=1;t<=88;t++){var n=t%12;if(_.includes(q,n)){var o=Math.floor(t/12),r=q.indexOf(n),a=7*o+r,i=U[r];e.font="c"==i?"bold 13px Tahoma":"13px Tahoma",e.fillStyle="#777",e.fillText(i,20*a+10,100),e.font="12px Consolas",e.fillStyle="#999",e.fillText(t,20*a+10,115)}}e.font="15px Consolas",e.fillStyle="#FFF",e.textAlign="center";for(var c=7*(L+1)-1,s=I.labels.length,l=0;l<s;l++)e.fillText(I.labels[l],20*(l+c)+10,140)}(e),function(e){var t=G.currentTrack(),n=G.currentNoteGroup(),o=se.getNoteGroupFromTrack(n,t);if(!o)return;var r,a=O(o.notes);try{for(a.s();!(r=a.n()).done;){var i=r.value,c=i.pianoNote%12,s=Math.floor((i.pianoNote-1)/12);if(e.beginPath(),_.includes(W,c)){var l=7*s+W.indexOf(c);e.arc(20*l+20,60,6,0,2*Math.PI,!1)}else{var u=7*s+q.indexOf(c);e.arc(20*u+10,96,7,0,2*Math.PI,!1)}e.fillStyle="rgba(220,220,10,.82)",e.fill()}}catch(f){a.e(f)}finally{a.f()}}(e)}},e.setupPianoMouseHandlers=function(){var e=[1,3,4,6,8,9,11],t=[2,0,5,7,0,10,12];function n(n,o){var r=0;if(o<=s){var a=Math.floor((n-12)/20);r=Math.floor(a/7);var i=a%7,c=(n-12)%20;if(c>=0&&c<=16&&1!==i&&4!==i)return 12*r+t[i]}var l=Math.floor(n/20),u=l%7;return 12*(r=Math.floor(l/7))+e[u]}var o=$("#pianoCanvas");o.mousedown((function(e){var t=this.offsetLeft,r=this.offsetTop,a=n(e.pageX-t,e.pageY-r),i=a;oe(a),o.mousemove((function(e){var o=n(e.pageX-t,e.pageY-r);o!==i&&(i=o,oe(o))}))})),$("html").mouseup((function(e){o.unbind("mousemove")}))}}(ce||(ce={})),function(e){var t=[],n=null,o=!1;function r(){o=!1,n=null}function a(e,n){r();var o=t[n];return e.trackNumber=n,e.noteNumber=o.length,o.push(e),t[n].length}e.reset=function(){t=[]},e.invalidateCache=r,e.addTrack=function(e){var n=new N;n.trackNumber=e,t.push(n)},e.addNoteGroupToTrack=a,e.getNumTracks=function(){return t.length},e.getNumNoteGroupsInTrack=function(e){return e<0||e>=t.length?0:t[e].length},e.getTracksAsJSON=function(){return JSON.stringify(t)},e.mergeLastTwoGroups=function(){var e=G.currentTrack(),n=t[e];n.length>=2&&(a(T.merge(n.pop(),n.pop()),e),G.setTrackAndNoteGroup(e,n.length-1),ee())},e.deleteLastGroup=function(){var e=G.currentTrack();t[e].pop(),G.setTrackAndNoteGroup(e,t[e].length-1),ee()},e.getNoteGroupFromTrack=function(e,n){if(n<0||n>=t.length)return null;var o=t[n];return e<0||e>=o.length?null:o[e]},e.getNoteGroupsFromTracks=function(){if(o)return n;console.log("Recompute Cached NoteGroups!!!");for(var e=[],r=0,a=[],i=[],c=t.length,s=0;s<c;s++)a.push(ce.isChecked(s)),i.push(0);for(;;){for(var l=Number.MAX_VALUE,u=null,f=null,d=0;d<c;d++){var p=t[d],h=i[d],g=p.length;if(0!==g&&a[d]&&!(h>=g)){var v=p[h];v.playTimeMillis<l&&(l=v.playTimeMillis,u=v,f=p)}}if(!u)break;var m=u.copy();-1===m.playTimeMillis&&(m.playTimeMillis=r);var b=f.trackNumber,y=i[b];m.noteNumber=y,i[b]++,e.push(m),r=m.playTimeMillis+250}return n=e,o=!0,e}}(se||(se={}));var fe=function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,[{key:"go",value:function(){M.setup(),ce.setupJQueryDOMReferences(),F.load(),ce.showNoteGroupsForTracks(),ce.setupKeyHandlers(),ce.setupMouseHandlers(),ce.setupFileChooser(),ce.setupCopyHandler(),ce.setupPianoCanvas(),ce.setupPianoMouseHandlers(),ce.drawPiano()}}]),e}(),de=n("q1tI"),pe=n("xgb5"),he=!0;t.default=function(){return Object(pe.a)("keydown",(function(e){32==e.keyCode||70==e.keyCode||68==e.keyCode||console.log(e.keyCode)})),Object(pe.a)("keyup",(function(e){})),Object(de.useEffect)((function(){(new fe).go()}),[]),Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{className:"jsx-126082336 download-div",children:["Save as"," ",Object(o.jsx)("a",{id:"download_midi_link",href:"data:text/plain;base64,Tm90aGluZw==",download:"song.mid",className:"jsx-126082336",children:"MIDI"}),"\xa0\xa0or\xa0",Object(o.jsx)("a",{id:"download_text_link",href:"data:text/plain;base64,Tm90aGluZw==",download:"song.txt",className:"jsx-126082336",children:"TEXT"})]}),Object(o.jsxs)("div",{className:"jsx-126082336 version-div",children:[Object(o.jsx)("div",{id:"toggle_v1",className:"jsx-126082336 version-toggle",children:"V1"}),Object(o.jsx)("div",{id:"toggle_v2",className:"jsx-126082336 version-toggle",children:"V2"})]}),Object(o.jsxs)("div",{className:"jsx-126082336 shortcuts",children:["ctrl \u2192 flat \xa0\xa0\xa0\xa0 alt \u2192 sharp \xa0\xa0\xa0\xa0 shift + esc \u2192 clear",Object(o.jsx)("br",{className:"jsx-126082336"}),"up/down \u2192 +/- octave \xa0\xa0\xa0\xa0 tab \u2192 combine \xa0\xa0\xa0\xa0 cmd + c \u2192 copy"]}),Object(o.jsxs)("div",{className:"jsx-126082336 sharps-and-flats",children:[Object(o.jsxs)("div",{className:"jsx-126082336",children:["sharps: ",Object(o.jsx)("input",{id:"sharps-text",className:"jsx-126082336"})]}),Object(o.jsxs)("div",{className:"jsx-126082336",children:["flats: ",Object(o.jsx)("input",{id:"flats-text",className:"jsx-126082336"})]})]}),Object(o.jsxs)("div",{id:"content",className:"jsx-126082336 content",children:[Object(o.jsx)("div",{id:"tracks",className:"jsx-126082336"}),Object(o.jsx)("canvas",{id:"pianoCanvas",width:"1040",height:"150",className:"jsx-126082336"})]}),Object(o.jsx)("div",{id:"current-status",className:"jsx-126082336",children:"\xa0"}),Object(o.jsxs)("div",{id:"bottom-panel",className:"jsx-126082336",children:[Object(o.jsxs)("div",{id:"upload-file",className:"jsx-126082336 bottom-info",children:[Object(o.jsx)("input",{type:"file",id:"filechooser",className:"jsx-126082336"}),Object(o.jsx)("label",{id:"filechooserlabel",htmlFor:"filechooser",className:"jsx-126082336",children:"Upload a MIDI file!"})]}),Object(o.jsx)("div",{id:"file-info",className:"jsx-126082336 bottom-info",children:"\xa0"}),Object(o.jsx)("div",{id:"song-info",className:"jsx-126082336 bottom-info",children:"\xa0"}),Object(o.jsxs)("div",{id:"buttons",className:"jsx-126082336",children:[Object(o.jsx)("a",{id:"play-button",href:"#",className:"jsx-126082336",children:"Play"})," ","|"," ",Object(o.jsx)("a",{id:"pause-button",href:"#",className:"jsx-126082336",children:"Pause"})," ","|"," ",Object(o.jsx)("a",{id:"stop-button",href:"#",className:"jsx-126082336",children:"Stop"})]})]}),Object(o.jsx)(a.a,{id:"1808733356",children:["html{margin:15px 1% 0px 1%;}"]}),Object(o.jsx)(a.a,{id:"1255802629",children:[".download-div.jsx-126082336{float:left;margin:3px 0px;}",".version-div.jsx-126082336{float:left;margin-left:8px;}",".shortcuts.jsx-126082336{float:right;}","#filechooser.jsx-126082336{display:none;}","html.drag.jsx-126082336{background-color:#dffafb;}",".content.jsx-126082336{width:100%;text-align:center;clear:both;padding-top:10px;}","input.jsx-126082336{width:50px;}","#bottom-panel.jsx-126082336{padding:20px;text-align:center;color:#444;background-color:#dedede;position:absolute;height:100px;bottom:0px;left:0px;right:0px;}","#bottom-panel.drag.jsx-126082336{background-color:#dffafb;font-weight:bold;color:#f66;}",".bottom-info.jsx-126082336{margin-bottom:10px;}","#upload-file.jsx-126082336{color:#39d;-webkit-text-decoration:underline;text-decoration:underline;}","#filechooserlabel.jsx-126082336{cursor:pointer;}",".track-container.jsx-126082336{height:40px;margin-bottom:6px;}",".track-container.empty.jsx-126082336{height:22px;}",".track.jsx-126082336{box-sizing:border-box;width:90%;height:100%;background-color:#dffafb;text-align:left;font-family:Inconsolata,Menlo,Monaco,sans-serif;font-size:11pt;overflow-x:scroll;overflow-y:hidden;margin:0;padding:0 10px;white-space:nowrap;display:inline-block;line-height:100%;-webkit-user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-bottom:1px solid rgba(255,255,255,0);}",".track.highlight.jsx-126082336{border-bottom:1px solid rgba(238,119,153,0.4);}",".track-info.jsx-126082336{box-sizing:border-box;width:38px;height:100%;background-color:#f0f4ff;color:#666;text-align:center;font-family:Inconsolata,Menlo,Monaco,sans-serif;font-size:11pt;overflow-x:scroll;overflow-y:hidden;white-space:nowrap;margin:0px 0;display:inline-block;line-height:40px;border-bottom:1px solid rgba(255,255,255,0);}",".track-info.highlight.jsx-126082336{border-bottom:1px solid rgba(238,119,153,0.4);}",".notegroup.jsx-126082336{box-sizing:border-box;display:inline-block;height:32px;line-height:32px;padding:0px 3px;margin:4px 1px 0px 1px;}",".notegroup.multiple.jsx-126082336{color:#59b;}",".notegroup.highlight.jsx-126082336{color:#f67;background-color:rgba(238,119,153,0.2);}",".checkbox.jsx-126082336{box-sizing:border-box;width:14px;height:100%;vertical-align:top;margin:0px;margin-right:6px;border:0px;padding:0px;}","#pianoCanvas.jsx-126082336{border:1px solid #444;margin-top:10px;cursor:pointer;}",".jsx-126082336::-webkit-scrollbar{width:0px;height:3px;}",".jsx-126082336::-webkit-scrollbar-thumb{border-radius:0px;background-color:rgba(0,0,0,0.18);}",".sharps-and-flats.jsx-126082336{float:right;margin-right:20px;text-align:right;}","#current-status.jsx-126082336{margin:10px 0;padding:6px 0px;width:100%;color:#333;background-color:#bdc;position:absolute;height:50px;bottom:100px;left:0px;right:0px;}","@keyframes played-note-animation 0%.jsx-126082336{background-color:rgba(55,180,255,0.85);color:#cdf;}","@keyframes played-note-animation 100%.jsx-126082336{background-color:rgba(55,180,255,0);color:#59f;}",".played-note.jsx-126082336{-webkit-animation-name:played-note-animation-jsx-126082336;animation-name:played-note-animation-jsx-126082336;-webkit-animation-duration:0.4s;animation-duration:0.4s;}",".version-toggle.jsx-126082336{float:left;background-color:#eee;color:#777;padding:3px 15px;cursor:pointer;}",".version-toggle.selected.jsx-126082336{color:#333;background-color:#cdedff;}","@media only screen and (max-width:1024px){.checkbox.jsx-126082336{width:18px;}.track-info.jsx-126082336{width:20px;}.track.jsx-126082336{width:88%;}}"]})]})}},"hKI/":function(e,t,n){(function(t){var n=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,a=/^0o[0-7]+$/i,i=parseInt,c="object"==typeof t&&t&&t.Object===Object&&t,s="object"==typeof self&&self&&self.Object===Object&&self,l=c||s||Function("return this")(),u=Object.prototype.toString,f=Math.max,d=Math.min,p=function(){return l.Date.now()};function h(e,t,n){var o,r,a,i,c,s,l=0,u=!1,h=!1,m=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function b(t){var n=o,a=r;return o=r=void 0,l=t,i=e.apply(a,n)}function y(e){return l=e,c=setTimeout(k,t),u?b(e):i}function x(e){var n=e-s;return void 0===s||n>=t||n<0||h&&e-l>=a}function k(){var e=p();if(x(e))return j(e);c=setTimeout(k,function(e){var n=t-(e-s);return h?d(n,a-(e-l)):n}(e))}function j(e){return c=void 0,m&&o?b(e):(o=r=void 0,i)}function N(){var e=p(),n=x(e);if(o=arguments,r=this,s=e,n){if(void 0===c)return y(s);if(h)return c=setTimeout(k,t),b(s)}return void 0===c&&(c=setTimeout(k,t)),i}return t=v(t)||0,g(n)&&(u=!!n.leading,a=(h="maxWait"in n)?f(v(n.maxWait)||0,t):a,m="trailing"in n?!!n.trailing:m),N.cancel=function(){void 0!==c&&clearTimeout(c),l=0,o=s=r=c=void 0},N.flush=function(){return void 0===c?i:j(p())},N}function g(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(g(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=g(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var c=r.test(e);return c||a.test(e)?i(e.slice(2),c?2:8):o.test(e)?NaN:+e}e.exports=function(e,t,n){var o=!0,r=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return g(n)&&(o="leading"in n?!!n.leading:o,r="trailing"in n?!!n.trailing:r),h(e,t,{leading:o,maxWait:t,trailing:r})}}).call(this,n("yLpj"))},yLpj:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(o){"object"===typeof window&&(n=window)}e.exports=n},yWwD:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/piano/v2",function(){return n("YSrY")}])}},[["yWwD",0,1,2,3,5]]]);