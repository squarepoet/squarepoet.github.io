(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[3],{"1OyB":function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}i.d(t,"a",(function(){return n}))},B7GI:function(e,t,i){"use strict";(function(e){var n,r=i("1OyB"),a=i("vuIU"),o=i("rePB");!function(t){var i=function(e){return function(t){function i(t){var i,n=t.real.length,r=new Float32Array(n),a=new Float32Array(n);for(i=0;i<n;++i)r[i]=t.real[i],a[i]=t.imag[i];try{return e.createPeriodicWave(r,a)}catch(o){}try{return e.createWaveTable(r,a)}catch(o){}return null}function n(e,t,i){var n,r,a={real:[],imag:[]},o=e.real.length;for(n=0;n<o;++n)r=Math.log(t[Math.min(n,t.length-1)]),a.real.push(e.real[n]*Math.exp(i*r)),a.imag.push(e.imag[n]*Math.exp(i*r));return a}var r,a,o,s,u,l,c={};for(r in t)if(l=i(a=t[r])){if(u={wave:l},a.mult)for(s=t[r].freq,u.freq={},o=0;o<s.length;++o)(l=i(n(a,a.mult,(o+1)/s.length)))&&(u.freq[s[o]]=l);a.defs&&(u.defs=a.defs),c[r]=u}return c}({piano:{real:[0,0,-.203569,.5,-.401676,.137128,-.104117,.115965,-.004413,.067884,-.00888,.0793,-.038756,.011882,-.030883,.027608,-.013429,.00393,-.014029,.00972,-.007653,.007866,-.032029,.046127,-.024155,.023095,-.005522,.004511,-.003593,.011248,-.004919,.008505],imag:[0,.147621,0,7e-6,-1e-5,5e-6,-6e-6,9e-6,0,8e-6,-1e-6,14e-6,-8e-6,3e-6,-9e-6,9e-6,-5e-6,2e-6,-7e-6,5e-6,-5e-6,5e-6,-23e-6,37e-6,-21e-6,22e-6,-6e-6,5e-6,-4e-6,14e-6,-7e-6,12e-6],mult:[1,1,.18,.016,.01,.01,.01,.004,.014,.02,.014,.004,.002,1e-5],freq:[65,80,100,135,180,240,620,1360],defs:{wave:"piano",gain:.5,attack:.002,decay:.25,sustain:.03,release:.1,decayfollow:.7,cutoff:800,cutfollow:.1,resonance:1,detune:.9994}}})},n=function(){function t(){Object(r.a)(this,t)}return Object(a.a)(t,null,[{key:"isAudioPresent",value:function(){return!(!e.AudioContext&&!e.webkitAudioContext)}},{key:"getAudioTop",value:function(){if(t._audioTop)return t._audioTop;if(!t.isAudioPresent())return null;var n=new(e.AudioContext||e.webkitAudioContext);return t._audioTop={ac:n,wavetable:i(n),out:null,currentStart:null},t.resetAudio(),t._audioTop}},{key:"resetAudio",value:function(){if(t._audioTop){var e=t._audioTop;e.out&&(e.out.disconnect(),e.out=null,e.currentStart=null);var i=e.ac.createDynamicsCompressor();i.ratio.setValueAtTime(16,0),i.attack.setValueAtTime(5e-4,0),i.connect(e.ac.destination),e.out=i}}},{key:"audioCurrentStartTime",value:function(){var e=t.getAudioTop();return null!=e.currentStart||(e.currentStart=Math.max(.25,e.ac.currentTime),setTimeout((function(){e.currentStart=null}),0)),e.currentStart}},{key:"midiToFrequency",value:function(e){return 440*Math.pow(2,(e-69)/12)}},{key:"frequencyToMidi",value:function(e){return Math.round(69+12*Math.log(e/440)/Math.LN2)}},{key:"pitchToMidi",value:function(e){var i=/^(\^+|_+|=|)([A-Ga-g])([,']*)$/.exec(e);if(!i)return null;var n=i[3].replace(/,/g,"").length-i[3].replace(/'/g,"").length;return t.noteNum[i[2]]+t.accSym[i[1].charAt(0)]*i[1].length+12*n+60}},{key:"midiToPitch",value:function(e){var i=(e-72)%12;(e>60||0!=i)&&(i+=12);for(var n=Math.round((e-i-60)/12),r=t.noteName[i];0!=n;)r+=n>0?"'":",",n+=n>0?-1:1;return r}},{key:"pitchToFrequency",value:function(e){return t.midiToFrequency(t.pitchToMidi(e))}},{key:"makeTimbre",value:function(e,i){e||(e={}),"string"==typeof e&&(e={wave:e});var n,r={},a=i&&i.wavetable&&i.wavetable[e.wave];for(n in t.defaultTimbre)e.hasOwnProperty(n)?r[n]=e[n]:a&&a.defs&&a.defs.hasOwnProperty(n)?r[n]=a.defs[n]:r[n]=t.defaultTimbre[n];return r}},{key:"getWhiteNoiseBuf",value:function(){if(null==n)for(var e=t.getAudioTop().ac,i=2*e.sampleRate,n=e.createBuffer(1,i,e.sampleRate),r=n.getChannelData(0),a=0;a<i;a++)r[a]=2*Math.random()-1;return n}},{key:"makeOscillator",value:function(e,i,n){if("noise"==i){var r=e.ac.createBufferSource();return r.buffer=t.getWhiteNoiseBuf(),r.loop=!0,r}var a,o,s,u,l=e.wavetable,c=e.ac.createOscillator();try{if(l.hasOwnProperty(i)){if(o=l[i].wave,l[i].freq)for(a in s=0,l[i].freq)n>(u=Number(a))&&u>s&&(s=u,o=l[i].freq[s]);!c.setPeriodicWave&&c.setWaveTable?c.setWaveTable(o):c.setPeriodicWave(o)}else c.type=i}catch(h){window.console&&window.console.log(h),c.type="square"}return c.frequency.setTargetAtTime(n,e.ac.currentTime,.001),c}}]),t}();Object(o.a)(n,"_audioTop",null),Object(o.a)(n,"noteNum",{C:0,D:2,E:4,F:5,G:7,A:9,B:11,c:12,d:14,e:16,f:17,g:19,a:21,b:23}),Object(o.a)(n,"accSym",{"^":1,"":0,"=":0,_:-1}),Object(o.a)(n,"noteName",["C","^C","D","_E","E","F","^F","G","_A","A","_B","B","c","^c","d","_e","e","f","^f","g","_a","a","_b","b"]),Object(o.a)(n,"defaultTimbre",{wave:"square",gain:.1,attack:.002,decay:.4,decayfollow:0,sustain:0,release:.1,cutoff:0,cutfollow:0,resonance:0,detune:0}),Object(o.a)(n,"whiteNoiseBuf",null);var s=/^([A-Za-z]):\s*(.*)$/,u=/(?:\[[A-Za-z]:[^\]]*\])|\s+|%[^\n]*|![^\s!:|\[\]]*!|\+[^+|!]*\+|[_<>@^]?"[^"]*"|\[|\]|>+|<+|(?:(?:\^+|_+|=|)[A-Ga-g](?:,+|'+|))|\(\d+(?::\d+){0,2}|\d*\/\d+|\d+\/?|\/+|[xzXZ]|\[?\|\]?|:?\|:?|::|./g;function l(e){var t,i,r,a,o=e.split("\n"),l={},c=l,h={},f={slurred:0};for(t=0;t<o.length;++t)if(r=s.exec(o[t]))d(r[1],r[2].trim());else{if(/^\s*(?:%.*)?$/.test(o[t]))continue;b(o[t])}var m=["unitnote","unitbeat","tempo"];if(l.hasOwnProperty("voice")&&null!==l.voice){for(t in a=[],l.voice)if(l.voice[t].stems&&l.voice[t].stems.length){for(_(l.voice[t].stems),i=0;i<m.length;++i)!(m[i]in l)&&m[i]in l.voice[t]&&(l[m[i]]=l.voice[t][m[i]]);delete l.voice[t].accent}else a.push(t);for(t=0;t<a.length;++t)delete l.voice[a[t]]}return l;function d(e,t){switch(e){case"V":c!==l&&p(t.split(" ")[0]);break;case"M":!function(e,t){var i=/^C/.test(e)?1:x(e);if(!i)return;t.unitnote||(t.unitnote=i<.75?1/16:1/8)}(t,c);break;case"L":!function(e,t){var i=x(e);if(!i)return;t.unitnote=i}(t,c);break;case"Q":!function(e,t){var i,n=e.split(/\s+|=/),r=null,a=null;for(i=0;i<n.length;++i)n[i].indexOf("/")>=0||/^[1-4]$/.test(n[i])?r=r||x(n[i]):a=a||Number(n[i]);r&&(t.unitbeat=r);a&&(t.tempo=a)}(t,c)}c.hasOwnProperty(e)?c[e]+="\n"+t:c[e]=t,"K"==e&&(h=function(e){if(!e)return{};var t,i={"c#":7,"f#":6,b:5,e:4,a:3,d:2,g:1,c:0,f:-1,bb:-2,eb:-3,ab:-4,db:-5,gb:-6,cb:-7,"a#m":7,"d#m":6,"g#m":5,"c#m":4,"f#m":3,bm:2,em:1,am:0,dm:-1,gm:-2,cm:-3,fm:-4,bbm:-5,ebm:-6,abm:-7,"g#mix":7,"c#mix":6,"f#mix":5,bmix:4,emix:3,amix:2,dmix:1,gmix:0,cmix:-1,fmix:-2,bbmix:-3,ebmix:-4,abmix:-5,dbmix:-6,gbmix:-7,"d#dor":7,"g#dor":6,"c#dor":5,"f#dor":4,bdor:3,edor:2,ador:1,ddor:0,gdor:-1,cdor:-2,fdor:-3,bbdor:-4,ebdor:-5,abdor:-6,dbdor:-7,"e#phr":7,"a#phr":6,"d#phr":5,"g#phr":4,"c#phr":3,"f#phr":2,bphr:1,ephr:0,aphr:-1,dphr:-2,gphr:-3,cphr:-4,fphr:-5,bbphr:-6,ebphr:-7,"f#lyd":7,blyd:6,elyd:5,alyd:4,dlyd:3,glyd:2,clyd:1,flyd:0,bblyd:-1,eblyd:-2,ablyd:-3,dblyd:-4,gblyd:-5,cblyd:-6,fblyd:-7,"b#loc":7,"e#loc":6,"a#loc":5,"d#loc":4,"g#loc":3,"c#loc":2,"f#loc":1,bloc:0,eloc:-1,aloc:-2,dloc:-3,gloc:-4,cloc:-5,floc:-6,bbloc:-7},n=e.replace(/\s+/g,"").toLowerCase().substr(0,5),r=n.match(/maj|min|mix|dor|phr|lyd|loc|m/);t=r?"maj"==r?n.substr(0,r.index):"min"==r?n.substr(0,r.index+1):n.substr(0,r.index+r[0].length):/^[a-g][#b]?/.exec(n)||"";var a=function(e){var t,i="FCGDAEB",n={};if(!e)return n;if(e>0)for(t=0;t<e&&t<7;++t)n[i.charAt(t)]="^";else for(t=0;t>e&&t>-7;--t)n[i.charAt(6+t)]="_";return n}(i[t]),o=e.substr(t.length).match(/(_+|=|\^+)[a-g]/gi);if(o)for(var s=0;s<o.length;++s){var u=o[s].charAt(o[s].length-1).toUpperCase();"="==o[s].charAt(0)?delete a[u]:a[u]=o[s].substr(0,o[s].length-1)}return a}(t),c===l&&p(g()))}function p(e){((e=e||"")||c===l)&&(l.voice||(l.voice={}),l.voice.hasOwnProperty(e)?(c=l.voice[e],f=c.accent):(c={id:e,accent:{slurred:0}},l.voice[e]=c,f=c.accent))}function g(){return l.V?l.V.split(/\s+/)[0]:""}function b(e){var t,i=e.match(u),n=null,r=0,a=0,o=null;if(!i)return null;for(;r<i.length;)if(/^[\s%]/.test(i[r]))r++;else if(/^\[[A-Za-z]:[^\]]*\]$/.test(i[r]))d(i[r].substring(1,2),i[r].substring(3,i[r].length-1).trim()),r++;else if(/</.test(i[r]))a=-i[r++].length;else if(/>/.test(i[r]))a=i[r++].length;else if(/^\(\d+(?::\d+)*/.test(i[r]))o=w(i[r++]);else if(/^[!+].*[!+]$/.test(i[r]))k(i[r++],f);else if(/^.?".*"$/.test(i[r]))r++;else if(/^[()]$/.test(i[r]))"("==i[r++]?f.slurred+=1:(f.slurred-=1,f.slurred<=0&&(f.slurred=0,c.stems&&c.stems.length>=1&&y(c.stems[c.stems.length-1],!1)));else if(/\|/.test(i[r])){for(t in f)1==t.length&&delete f[t];r++}else null!==(n=S(i,r,h,f))?(o&&(T(n.stem,o.time),o.count-=1,o.count||(o=null)),a&&c.stems&&c.stems.length&&(t=a>0?(1-Math.pow(.5,a))*n.stem.time:(Math.pow(.5,-a)-1)*c.stems[c.stems.length-1].time,v(c.stems[c.stems.length-1],t),v(n.stem,-t)),a=0,f.slurred&&y(n.stem,!0),c===l&&p(g()),"stems"in c||(c.stems=[]),c.stems.push(n.stem),r=n.index):r++}function _(e){var t,i,n,r,a,o={};for(i=0;i<e.length;++i){for(t={},n=0;n<e[i].notes.length;++n)a=r=e[i].notes[n],o.hasOwnProperty(r.pitch)&&((a=o[r.pitch]).time+=r.time,r.holdover=!0),r.tie&&(t[r.pitch]=a);o=t}}function v(e,t){var i,n,r=e.time,a=r+t;for(e.time=a,i=0;i<e.notes.length;++i)(n=e.notes[i]).time==r&&(n.time=a)}function y(e,t){var i,n;for(i=0;i<e.notes.length;++i)n=e.notes[i],t?n.slurred=!0:n.slurred&&delete n.slurred}function T(e,t){var i;for(e.time*=t,i=0;i<e.notes.length;++i)e.notes[i].time*=t}function w(e){var t=/^\((\d+)(?::(\d+)(?::(\d+))?)?$/.exec(e);if(!t)return null;var i=Number(t[1]);return{time:(Number(t[2])||2)/i,count:Number(t[3])||i}}function k(e,t){if(!(e.length<2))switch(e=e.substring(1,e.length-1)){case"pppp":case"ppp":t.dynamics=.2;break;case"pp":t.dynamics=.4;break;case"p":t.dynamics=.6;break;case"mp":t.dynamics=.8;break;case"mf":t.dynamics=1;break;case"f":t.dynamics=1.2;break;case"ff":t.dynamics=1.4;break;case"fff":case"ffff":t.dynamics=1.5}}function S(e,t,i,r){var a,o,s,u,l=[],c="",h=!1,f=null,m=1/0;if(t<e.length&&"."==e[t]&&(h=!0,t++),t<e.length&&"["==e[t]){for(t++;t<e.length;)if(/^[\s%]/.test(e[t]))t++;else{if(/[A-Ga-g]/.test(e[t]))(f={pitch:A(e[t++],i,r),tie:!1}).frequency=n.pitchToFrequency(f.pitch),l.push(f);else{if(!/[xzXZ]/.test(e[t])){if("."==e[t]){h=!0,t++;continue}break}f=null,t++}t<e.length&&/^(?![\s%!]).*[\d\/]/.test(e[t])?o=x(a=e[t++]):(a="",o=1),f&&(f.duration=a,f.time=o),o&&o<m&&(c=a,m=o),t<e.length&&"-"==e[t]&&(f&&(l[l.length-1].tie=!0),t++)}if("]"!=e[t])return null;t++}else if(t<e.length&&/[A-Ga-g]/.test(e[t]))(f={pitch:A(e[t++],i,r),tie:!1,duration:"",time:1}).frequency=n.pitchToFrequency(f.pitch),l.push(f);else{if(!(t<e.length&&/^[xzXZ]$/.test(e[t])))return null;t++}if(t<e.length&&/^(?![\s%!]).*[\d\/]/.test(e[t]))for(o=x(c=e[t++]),u=0;u<l.length;++u)l[u].duration=c,l[u].time=o;if(t<e.length&&"-"==e[t])for(t++,u=0;u<l.length;++u)l[u].tie=!0;if(r.dynamics)for(s=r.dynamics,u=0;u<l.length;++u)l[u].velocity=s;return{index:t,stem:{notes:l,duration:c,staccato:h,time:x(c)}}}function O(e){return e.length>0&&"="==e.charAt(0)?e.substr(1):e}function A(e,t,i){var n,r=/^(\^+|_+|=|)([A-Ga-g])(.*)$/.exec(e);return r?(n=r[2].toUpperCase(),r[1].length>0?(i[n]=r[1],O(e)):i.hasOwnProperty(n)?O(i[n]+r[2]+r[3]):t.hasOwnProperty(n)?O(t[n]+r[2]+r[3]):O(e)):e}function x(e){var t,i,n,r=/^(\d*)(?:\/(\d*))?$|^(\/+)$/.exec(e),a=0;if(r){if(r[3])return Math.pow(.5,r[3].length);if(i=r[2]?parseFloat(r[2]):/\//.test(e)?2:1,n=0,t=r[1]?parseFloat(r[1]):1,r[2])for(;n+1<r[1].length&&t>i;)n+=1,a=parseFloat(r[1].substring(0,n)),t=parseFloat(r[1].substring(n));return a+t/i}}}t.parseABCFile=l;var c=function(){function e(t){Object(r.a)(this,e),Object(o.a)(this,"_out",void 0),Object(o.a)(this,"_atop",void 0),Object(o.a)(this,"_timbre",void 0),Object(o.a)(this,"_queue",void 0),Object(o.a)(this,"_minQueueTime",void 0),Object(o.a)(this,"_maxScheduledTime",void 0),Object(o.a)(this,"_unsortedQueue",void 0),Object(o.a)(this,"_startSet",void 0),Object(o.a)(this,"_finishSet",void 0),Object(o.a)(this,"_cleanupSet",void 0),Object(o.a)(this,"_callbackSet",void 0),Object(o.a)(this,"_handlers",void 0),Object(o.a)(this,"_now",void 0),Object(o.a)(this,"_pollTimer",void 0),this._atop=n.getAudioTop(),this._timbre=n.makeTimbre(t,this._atop),this._queue=[],this._minQueueTime=1/0,this._maxScheduledTime=0,this._unsortedQueue=!1,this._startSet=[],this._finishSet={},this._cleanupSet=[],this._callbackSet=[],this._handlers={},this._now=null,n.isAudioPresent()&&this.silence()}return Object(a.a)(e,null,[{key:"pitchToMidi",value:function(e){return"string"==typeof e?n.pitchToMidi(e):e}},{key:"midiToPitch",value:function(e){return"number"==typeof e?n.midiToPitch(e):e}}]),Object(a.a)(e,[{key:"setTimbre",value:function(e){this._timbre=n.makeTimbre(e,this._atop)}},{key:"getTimbre",value:function(e){return n.makeTimbre(this._timbre,this._atop)}},{key:"setVolume",value:function(e){this._out&&(isNaN(e)||(this._out.gain.value=e))}},{key:"getVolume",value:function(e){return this._out?this._out.gain.value:0}},{key:"silence",value:function(){var e,t,i,r=1;for(e in this._queue.length=0,this._minQueueTime=1/0,this._maxScheduledTime=0,this._startSet.length=0,t=this._finishSet,this._finishSet={},i=this._callbackSet,this._callbackSet=[],this._out&&(this._out.disconnect(),r=this._out.gain.value),this._atop=n.getAudioTop(),this._out=this._atop.ac.createGain(),this._out.gain.setTargetAtTime(r,this._atop.ac.currentTime,.001),this._out.connect(this._atop.out),t)this._trigger("noteoff",t[e]);for(e=0;e<i.length;++e)i[e].callback()}},{key:"now",value:function(){return null!=this._now||this._startPollTimer(!0),this._now}},{key:"on",value:function(e,t){this._handlers.hasOwnProperty(e)||(this._handlers[e]=[]),this._handlers[e].push(t)}},{key:"off",value:function(e,t){if(this._handlers.hasOwnProperty(e))if(t){var i,n=this._handlers[e];for(i=0;i<n.length;++i)n[i]===t&&(n.splice(i,1),i-=1)}else this._handlers[e]=[]}},{key:"_trigger",value:function(e,t){var i,n=this._handlers[e];if(n)if(1!=n.length)for(n=n.slice(),i=0;i<n.length;++i)n[i](t);else n[0](t)}},{key:"_makeSound",value:function(t){var i,r,a,o,s=t.timbre||this._timbre,u=t.time+e.timeOffset,l=u+t.duration,c=Math.min(l,u+s.attack),h=s.decay*Math.pow(440/t.frequency,s.decayfollow),f=c,m=l+s.release,d=s.detune&&1!=s.detune,p=s.gain*t.velocity*(d?.5:1),g=this._atop.ac;if(t.duration>0&&t.velocity>0){for((i=g.createGain()).gain.setValueAtTime(0,u),i.gain.linearRampToValueAtTime(p,c);f<c+1/32&&f+1/256<l;)f+=1/256,i.gain.linearRampToValueAtTime(p*(s.sustain+(1-s.sustain)*Math.exp((c-f)/h)),f);i.gain.setTargetAtTime(p*s.sustain,f,h),i.gain.setValueAtTime(p*(s.sustain+(1-s.sustain)*Math.exp((c-l)/h)),l),i.gain.linearRampToValueAtTime(0,m),i.connect(this._out),!s.cutoff&&!s.cutfollow||s.cutoff==1/0?r=i:((r=g.createBiquadFilter()).frequency.setTargetAtTime(s.cutoff+t.frequency*s.cutfollow,this._atop.ac.currentTime,.001),r.Q.setTargetAtTime(s.resonance,this._atop.ac.currentTime,.001),r.connect(i)),(a=n.makeOscillator(this._atop,s.wave,t.frequency)).connect(r),a.start(u),a.stop(m),d&&((o=n.makeOscillator(this._atop,s.wave,t.frequency*s.detune)).connect(r),o.start(u),o.stop(m)),t.gainNode=i,t.oscillators=[a],d&&t.oscillators.push(o),t.cleanuptime=m}else t.duration=0;this._startSet.push(t)}},{key:"_truncateSound",value:function(t,i){if(i<t.time+t.duration&&(t.duration=Math.max(0,i-t.time),t.gainNode)){var n,r=t.timbre||this._timbre,a=t.time+e.timeOffset,o=i+e.timeOffset,s=Math.min(o,a+r.attack),u=r.decay*Math.pow(440/t.frequency,r.decayfollow),l=o+r.release,c=l+e.cleanupDelay,h=r.detune&&1!=r.detune,f=r.gain*t.velocity*(h?.5:1),m=t.gainNode;if(m.gain.cancelScheduledValues(o),o<=a?m.gain.setValueAtTime(0,o):o<=s?m.gain.linearRampToValueAtTime(f*(o-a)/(s-a),a):m.gain.setValueAtTime(f*(r.sustain+(1-r.sustain)*Math.exp((s-o)/u)),o),m.gain.linearRampToValueAtTime(0,l),t.oscillators)for(n=0;n<t.oscillators.length;++n)t.oscillators[n].stop(l);t.cleanuptime=c}}},{key:"_doPoll",value:function(){if(this._pollTimer=null,this._now=null,window.hasOwnProperty("interrupted")&&!0===window.interrupted)this.silence();else{var t,i,n,r,a,o,s,u=this._atop.ac.currentTime+5e-4,l=[];if(this._minQueueTime-u<=e.bufferSecs){for(this._unsortedQueue&&(this._queue.sort((function(e,t){return e.time!=t.time?e.time-t.time:e.duration!=t.duration?e.duration-t.duration:e.frequency-t.frequency})),this._unsortedQueue=!1),t=0;t<this._queue.length&&!(this._queue[t].time-u>e.bufferSecs);++t);if(t>0){for(i=this._queue.splice(0,t),t=0;t<i.length;++t)this._makeSound(i[t]);this._minQueueTime=this._queue.length>0?this._queue[0].time:1/0}}for(t=0;t<this._cleanupSet.length;++t)(a=this._cleanupSet[t]).cleanuptime<u&&(a.gainNode&&(a.gainNode.disconnect(),a.gainNode=null),this._cleanupSet.splice(t,1),t-=1);for(r in this._finishSet)(n=(a=this._finishSet[r]).time+a.duration)<=u&&(l.push({order:[n,0],f:this._trigger,t:this,a:["noteoff",a]}),a.cleanuptime!=1/0&&this._cleanupSet.push(a),delete this._finishSet[r]);for(t=0;t<this._callbackSet.length;++t)(n=(s=this._callbackSet[t]).time)<=u&&(l.push({order:[n,1],f:s.callback,t:null,a:[]}),this._callbackSet.splice(t,1),t-=1);for(t=0;t<this._startSet.length;++t)this._startSet[t].time<=u&&(a=this._startSet[t],r=a.frequency,o=null,this._finishSet.hasOwnProperty(r)&&((o=this._finishSet[r]).time<a.time||o.time==a.time&&o.duration<a.duration?(this._truncateSound(o,a.time),l.push({order:[a.time,0],f:this._trigger,t:this,a:["noteoff",o]}),delete this._finishSet[r]):(this._truncateSound(a,o.time),o=a)),this._startSet.splice(t,1),t-=1,a.duration>0&&a.velocity>0&&o!==a&&(this._finishSet[r]=a,l.push({order:[a.time,2],f:this._trigger,t:this,a:["noteon",a]})));for(this._startPollTimer(),l.sort((function(e,t){return e.order[0]!=t.order[0]?e.order[0]-t.order[0]:e.order[1]-t.order[1]})),t=0;t<l.length;++t)(s=l[t]).f.apply(s.t,s.a)}}},{key:"_startPollTimer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._pollTimer||null==this._now){var i,r,a=this,o=function(){a._doPoll()},s=1/0;if(this._pollTimer&&(clearTimeout(this._pollTimer),this._pollTimer=null),t)return this._now=n.audioCurrentStartTime(),void(this._pollTimer=setTimeout(o,0));for(i=0;i<this._startSet.length;++i)s=Math.min(s,this._startSet[i].time);for(i in this._finishSet)s=Math.min(s,this._finishSet[i].time+this._finishSet[i].duration);for(i=0;i<this._callbackSet.length;++i)s=Math.min(s,this._callbackSet[i].time);this._cleanupSet.length>0&&(s=Math.min(s,this._cleanupSet[0].cleanuptime+1)),s=Math.min(s,this._minQueueTime-e.dequeueTime),r=Math.max(.001,s-this._atop.ac.currentTime),isNaN(r)||r==1/0||(this._pollTimer=setTimeout(o,Math.round(1e3*r)))}}},{key:"tone",value:function(t,i,r,a,o,s){if(this._atop){var u,l;if("object"==typeof t&&(null==r&&(r=t.velocity),null==i&&(i=t.duration),null==a&&(a=t.delay),null==o&&(o=t.timbre),null==s&&(s=t.origin),t=t.pitch),t||(t="C"),isNaN(t)?(u=n.pitchToMidi(t),l=n.midiToFrequency(u)):(l=Number(t))<0?(u=-l,l=n.midiToFrequency(u)):u=n.frequencyToMidi(l),o||(o=this._timbre),o!==this._timbre){var c,h=o;for(c in o={},n.defaultTimbre)o[c]=c in h?h[c]:n.defaultTimbre[c]}this._atop.ac;var f=this.now(),m=f+(a||0),d={time:m,on:!1,frequency:l,midi:u,velocity:null==r?1:r,duration:null==i?e.toneLength:i,timbre:o,instrument:this,gainNode:null,oscillators:null,cleanuptime:1/0,origin:s};m<f+e.bufferSecs?this._makeSound(d):(!this._unsortedQueue&&this._queue.length&&m<this._queue[this._queue.length-1].time&&(this._unsortedQueue=!0),this._queue.push(d),this._minQueueTime=Math.min(this._minQueueTime,d.time))}}},{key:"schedule",value:function(e,t){this._callbackSet.push({time:this.now()+e,callback:t})}},{key:"play",value:function(e){var t,i,r,a,o,s,u,c,h,f,m,d,p,g,b,_,v=Array.prototype.slice.call(arguments),y=null,T={},w=0,k=[];if(v.length&&"function"==typeof v[v.length-1]&&(y=v.pop()),this._atop){if(r=0,"object"==typeof v[0]){for(o in v[0])v[0].hasOwnProperty(o)&&(T[o]=v[0][o]);r=1,T.hasOwnProperty("song")&&v.push(T.song)}for(;r<v.length;++r)for(t=v[r].split(/\n(?=X:)/),o=0;o<t.length;++o)(i=l(t[o]))&&(!T.hasOwnProperty("tempo")&&i.tempo&&(T.tempo=i.tempo,i.unitbeat&&(T.tempo=T.tempo*i.unitbeat/(i.unitnote||1))),i.voice&&k.push(i));for(T.hasOwnProperty("tempo")||(T.tempo=120),T.hasOwnProperty("volume")||(T.volume=1),g=60/T.tempo,o=0;o<k.length;++o)for(f in(i=k[o]).voice)if(a=n.makeTimbre(T.timbre||i.voice[f].timbre||i.timbre||this._timbre,this._atop),c=i.voice[f].stems){for(s=0,h=0;h<c.length;++h){for(d=c[h],u=1/Math.sqrt(d.notes.length),m=0;m<d.notes.length;++m)(p=d.notes[m]).holdover||(b=(p.time||d.time)*g,d.staccato?b=Math.min(Math.min(b,g/16),a.attack+a.decay):!p.slurred&&b>=1/8&&(b-=1/32),_=(p.velocity||1)*u*T.volume,this.tone(p.pitch,b,_,s,a,p));s+=d.time*g}w=Math.max(s,w)}this._maxScheduledTime=Math.max(this._maxScheduledTime,this.now()+w),y&&this.schedule(w,y)}else y&&y()}},{key:"dispose",value:function(){console.log("Musical.js Instrument.dispose() is not implemented.")}}]),e}();Object(o.a)(c,"timeOffset",.0625),Object(o.a)(c,"dequeueTime",.5),Object(o.a)(c,"bufferSecs",2),Object(o.a)(c,"toneLength",1),Object(o.a)(c,"cleanupDelay",.1),t.Instrument=c}(n||(n={})),t.a=n}).call(this,i("yLpj"))},rePB:function(e,t,i){"use strict";function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,"a",(function(){return n}))},vuIU:function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}i.d(t,"a",(function(){return r}))},yLpj:function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(n){"object"===typeof window&&(i=window)}e.exports=i}}]);